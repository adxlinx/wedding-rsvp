<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Attendance Survey</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #8b7355;
            --secondary: #d4a373;
            --accent: #c9ada7;
            --dark: #4a4238;
            --light: #f8f4f1;
            --white: #ffffff;
            --shadow: rgba(139, 115, 85, 0.15);
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #f8f4f1 0%, #ede3dc 100%);
            min-height: 100vh;
            padding: 2rem 1rem;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(212, 163, 115, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(201, 173, 167, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
        }

        .ornament {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 1rem;
            animation: float 3s ease-in-out infinite;
        }

        .header h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3.5rem;
            font-weight: 300;
            color: var(--dark);
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 0.95rem;
            color: var(--primary);
            font-weight: 300;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .form-card {
            background: var(--white);
            border-radius: 2px;
            padding: 3rem;
            box-shadow: 
                0 10px 40px var(--shadow),
                0 2px 8px rgba(0,0,0,0.05);
            animation: fadeInUp 0.8s ease-out 0.2s both;
            position: relative;
        }

        .form-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--secondary), var(--accent), var(--secondary));
        }

        .section-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--accent);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--dark);
            margin-bottom: 0.5rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 0.9rem 1rem;
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            color: var(--dark);
            background: var(--light);
            border: 2px solid transparent;
            border-radius: 2px;
            transition: all 0.3s ease;
            outline: none;
        }

        input:focus,
        select:focus,
        textarea:focus {
            border-color: var(--secondary);
            background: var(--white);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L6 6L11 1' stroke='%238b7355' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .radio-group {
            display: flex;
            gap: 1.5rem;
            margin-top: 0.5rem;
        }

        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            position: relative;
        }

        .radio-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .radio-custom {
            width: 20px;
            height: 20px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            margin-right: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .radio-custom::after {
            content: '';
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--secondary);
            transform: scale(0);
            transition: transform 0.2s ease;
        }

        .radio-option input[type="radio"]:checked + .radio-custom {
            border-color: var(--secondary);
        }

        .radio-option input[type="radio"]:checked + .radio-custom::after {
            transform: scale(1);
        }

        .radio-option span {
            font-size: 0.95rem;
            color: var(--dark);
        }

        .guest-info {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 2px;
            margin-top: 1rem;
            border-left: 3px solid var(--secondary);
        }

        .guest-count {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .guest-count strong {
            color: var(--secondary);
            font-size: 2rem;
        }

        .add-guest-btn {
            background: var(--light);
            color: var(--primary);
            border: 2px dashed var(--accent);
            padding: 0.8rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 2px;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 1rem;
        }

        .add-guest-btn:hover {
            background: var(--accent);
            color: var(--white);
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .guest-entry {
            background: var(--white);
            padding: 1rem;
            border-radius: 2px;
            margin-bottom: 0.8rem;
            border: 1px solid var(--accent);
            display: flex;
            gap: 1rem;
            align-items: center;
            animation: slideIn 0.3s ease;
        }

        .guest-entry input {
            margin-bottom: 0;
        }

        .remove-guest {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .remove-guest:hover {
            color: #d4534d;
            transform: scale(1.2);
        }

        .submit-btn {
            width: 100%;
            padding: 1.2rem;
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: var(--white);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--shadow);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .edit-mode-toggle {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--white);
            border: 2px solid var(--secondary);
            color: var(--primary);
            padding: 0.8rem 1.5rem;
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--shadow);
            z-index: 1000;
        }

        .edit-mode-toggle:hover {
            background: var(--secondary);
            color: var(--white);
            transform: translateY(-2px);
        }

        .edit-mode .editable {
            outline: 2px dashed var(--secondary);
            outline-offset: 4px;
            cursor: text;
        }

        .edit-panel {
            background: var(--white);
            padding: 2rem;
            border-radius: 2px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px var(--shadow);
            border-left: 4px solid var(--secondary);
        }

        .edit-panel h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .guest-allocations {
            margin-top: 1rem;
        }

        .allocation-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.8rem;
            align-items: center;
        }

        .allocation-item input {
            flex: 1;
        }

        .allocation-item button {
            background: #d4534d;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 2px;
            cursor: pointer;
            font-size: 0.85rem;
            text-transform: uppercase;
            transition: all 0.2s ease;
        }

        .allocation-item button:hover {
            background: #b83d38;
            transform: translateY(-1px);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .hidden {
            display: none !important;
        }

        /* Thank You Page Styles */
        .thank-you-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        .thank-you-card {
            background: var(--white);
            border-radius: 2px;
            padding: 4rem 3rem;
            max-width: 600px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transform: scale(0.8);
            animation: popIn 0.5s ease 0.2s forwards;
        }

        .thank-you-icon {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            animation: bounce 1s ease infinite;
        }

        .thank-you-card h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .thank-you-card p {
            font-size: 1.1rem;
            color: var(--primary);
            line-height: 1.8;
            margin-bottom: 2rem;
        }

        .thank-you-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .action-btn {
            padding: 1rem 2rem;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .action-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px var(--shadow);
        }

        .action-btn-secondary {
            background: var(--light);
            color: var(--primary);
            border: 2px solid var(--accent);
        }

        .action-btn-secondary:hover {
            background: var(--accent);
            color: var(--white);
            transform: translateY(-2px);
        }

        .response-summary {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 2px;
            margin: 2rem 0;
            text-align: left;
            border-left: 3px solid var(--secondary);
        }

        .response-summary h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3rem;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .response-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--accent);
        }

        .response-item:last-child {
            border-bottom: none;
        }

        .response-label {
            font-weight: 500;
            color: var(--primary);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .response-value {
            color: var(--dark);
            font-size: 0.95rem;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        @keyframes popIn {
            to {
                transform: scale(1);
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .form-card {
                padding: 2rem 1.5rem;
            }

            .edit-mode-toggle {
                top: 1rem;
                right: 1rem;
                padding: 0.6rem 1rem;
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <button class="edit-mode-toggle" onclick="toggleEditMode()">
        <span id="editModeText">‚úèÔ∏è Edit Form</span>
    </button>

    <div class="container">
        <div class="header">
            <div class="ornament">‚ù¶</div>
            <h1 class="editable" contenteditable="false">Wedding Celebration</h1>
            <p class="editable" contenteditable="false">Please share your attendance details</p>
        </div>

        <div id="editPanel" class="edit-panel hidden">
            <h3>Form Configuration</h3>
            <div class="form-group">
                <label>Guest Name Allocations</label>
                <p style="font-size: 0.85rem; color: var(--primary); margin-bottom: 1rem;">
                    Set the number of guests allowed for each family/individual when selected
                </p>
                <div id="guestAllocations" class="guest-allocations">
                    <!-- Dynamically populated -->
                </div>
                <button class="add-guest-btn" onclick="addAllocation()">+ Add Guest Allocation</button>
            </div>
        </div>

        <div class="form-card">
            <form id="attendanceForm">
                <div class="section-title editable" contenteditable="false">Your Information</div>

                <div class="form-group">
                    <label class="editable" contenteditable="false">Select Your Name/Family</label>
                    <select id="guestSelect" name="guestName" required onchange="updateGuestAllocation()">
                        <option value="">-- Please Select --</option>
                    </select>
                </div>

                <div id="guestAllocationInfo" class="hidden">
                    <div class="guest-info">
                        <div class="guest-count">
                            You may bring up to <strong id="allocatedCount">0</strong> guests
                        </div>
                        <p style="font-size: 0.85rem; color: var(--primary);">
                            This includes yourself and any additional guests
                        </p>
                    </div>
                </div>

                <div class="form-group">
                    <label class="editable" contenteditable="false">Email Address</label>
                    <input type="email" name="email" placeholder="your.email@example.com" required>
                </div>

                <div class="form-group">
                    <label class="editable" contenteditable="false">Phone Number</label>
                    <input type="tel" name="phone" placeholder="+1 (555) 000-0000">
                </div>

                <div class="section-title editable" contenteditable="false" style="margin-top: 3rem;">Attendance</div>

                <div class="form-group">
                    <label class="editable" contenteditable="false">Will you be attending?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="attending" value="yes" required onchange="toggleGuestDetails()">
                            <div class="radio-custom"></div>
                            <span>Yes, delighted to attend</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="attending" value="no" required onchange="toggleGuestDetails()">
                            <div class="radio-custom"></div>
                            <span>Regretfully decline</span>
                        </label>
                    </div>
                </div>

                <div id="guestDetails" class="hidden">
                    <div class="form-group">
                        <label class="editable" contenteditable="false">Number of Guests Attending</label>
                        <input type="number" id="guestCount" name="guestCount" min="1" max="10" value="1" onchange="updateGuestNames()">
                        <p style="font-size: 0.85rem; color: var(--primary); margin-top: 0.5rem;">
                            Including yourself (max: <span id="maxGuests">10</span>)
                        </p>
                    </div>

                    <div class="form-group">
                        <label class="editable" contenteditable="false">Guest Names</label>
                        <div id="guestNames">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="editable" contenteditable="false">Dietary Restrictions or Special Requirements</label>
                        <textarea name="dietaryRestrictions" placeholder="Please let us know of any dietary restrictions, allergies, or special requirements..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label class="editable" contenteditable="false">Additional Message or Notes</label>
                    <textarea name="message" placeholder="Share your excitement or any questions you may have..."></textarea>
                </div>

                <button type="submit" class="submit-btn">Submit Response</button>
            </form>
        </div>
    </div>

    <!-- Thank You Overlay -->
    <div id="thankYouOverlay" class="thank-you-overlay hidden">
        <div class="thank-you-card">
            <div class="thank-you-icon">üéâ</div>
            <h2>Thank You!</h2>
            <p>Your response has been recorded successfully. We're so excited to celebrate with you!</p>
            
            <div class="response-summary" id="responseSummary">
                <!-- Dynamically populated -->
            </div>

            <div class="thank-you-actions">
                <button class="action-btn action-btn-primary" onclick="downloadPDF()">
                    üìÑ Download PDF
                </button>
                <button class="action-btn action-btn-secondary" onclick="closeThankYou()">
                    ‚úì Done
                </button>
            </div>
        </div>
    </div>

    <script>
        // Guest allocations data
        let guestAllocations = {
            "Smith Family": 4,
            "Johnson Family": 6,
            "Williams & Brown": 3,
            "Davis Household": 5,
            "Rodriguez Family": 4,
            "Martinez & Garcia": 2
        };

        // Initialize the form
        function initializeForm() {
            populateGuestSelect();
            renderAllocations();
        }

        // Populate the guest select dropdown
        function populateGuestSelect() {
            const select = document.getElementById('guestSelect');
            select.innerHTML = '<option value="">-- Please Select --</option>';
            
            Object.keys(guestAllocations).forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            });
        }

        // Update guest allocation display when name is selected
        function updateGuestAllocation() {
            const selectedGuest = document.getElementById('guestSelect').value;
            const allocationInfo = document.getElementById('guestAllocationInfo');
            const allocatedCount = document.getElementById('allocatedCount');
            const maxGuestsSpan = document.getElementById('maxGuests');
            const guestCountInput = document.getElementById('guestCount');

            if (selectedGuest && guestAllocations[selectedGuest]) {
                const allocated = guestAllocations[selectedGuest];
                allocatedCount.textContent = allocated;
                maxGuestsSpan.textContent = allocated;
                guestCountInput.max = allocated;
                guestCountInput.value = Math.min(guestCountInput.value || 1, allocated);
                allocationInfo.classList.remove('hidden');
                updateGuestNames();
            } else {
                allocationInfo.classList.add('hidden');
                guestCountInput.max = 10;
                maxGuestsSpan.textContent = 10;
            }
        }

        // Toggle guest details based on attendance
        function toggleGuestDetails() {
            const attending = document.querySelector('input[name="attending"]:checked').value;
            const guestDetails = document.getElementById('guestDetails');
            
            if (attending === 'yes') {
                guestDetails.classList.remove('hidden');
                updateGuestNames();
            } else {
                guestDetails.classList.add('hidden');
            }
        }

        // Update guest name inputs
        function updateGuestNames() {
            const count = parseInt(document.getElementById('guestCount').value) || 1;
            const container = document.getElementById('guestNames');
            container.innerHTML = '';

            for (let i = 1; i <= count; i++) {
                const guestEntry = document.createElement('div');
                guestEntry.className = 'guest-entry';
                guestEntry.innerHTML = `
                    <input type="text" name="guestName${i}" placeholder="Guest ${i} Full Name" required>
                `;
                container.appendChild(guestEntry);
            }
        }

        // Edit mode functionality
        let editMode = false;

        function toggleEditMode() {
            editMode = !editMode;
            const body = document.body;
            const editPanel = document.getElementById('editPanel');
            const editModeText = document.getElementById('editModeText');
            const editables = document.querySelectorAll('.editable');

            if (editMode) {
                body.classList.add('edit-mode');
                editPanel.classList.remove('hidden');
                editModeText.textContent = '‚úì Done Editing';
                editables.forEach(el => el.contentEditable = 'true');
            } else {
                body.classList.remove('edit-mode');
                editPanel.classList.add('hidden');
                editModeText.textContent = '‚úèÔ∏è Edit Form';
                editables.forEach(el => el.contentEditable = 'false');
            }
        }

        // Render allocation configuration
        function renderAllocations() {
            const container = document.getElementById('guestAllocations');
            container.innerHTML = '';

            Object.entries(guestAllocations).forEach(([name, count]) => {
                const item = document.createElement('div');
                item.className = 'allocation-item';
                item.innerHTML = `
                    <input type="text" value="${name}" onchange="updateAllocationName('${name}', this.value)">
                    <input type="number" value="${count}" min="1" max="20" style="max-width: 100px;" onchange="updateAllocationCount('${name}', this.value)">
                    <button onclick="removeAllocation('${name}')">Remove</button>
                `;
                container.appendChild(item);
            });
        }

        // Add new allocation
        function addAllocation() {
            const newName = `New Guest ${Object.keys(guestAllocations).length + 1}`;
            guestAllocations[newName] = 2;
            renderAllocations();
            populateGuestSelect();
        }

        // Update allocation name
        function updateAllocationName(oldName, newName) {
            if (newName && newName !== oldName && !guestAllocations[newName]) {
                guestAllocations[newName] = guestAllocations[oldName];
                delete guestAllocations[oldName];
                renderAllocations();
                populateGuestSelect();
            }
        }

        // Update allocation count
        function updateAllocationCount(name, count) {
            guestAllocations[name] = parseInt(count) || 1;
            updateGuestAllocation();
        }

        // Remove allocation
        function removeAllocation(name) {
            if (confirm(`Remove ${name} from the guest list?`)) {
                delete guestAllocations[name];
                renderAllocations();
                populateGuestSelect();
            }
        }

        // Google Sheets Integration
        // SETUP INSTRUCTIONS:
        // 1. Go to: https://script.google.com
        // 2. Create a new project
        // 3. Copy the Google Apps Script code from the setup instructions below
        // 4. Deploy as Web App and copy the URL
        // 5. Paste the URL in the GOOGLE_SCRIPT_URL variable below
        
        const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE';
        
        // Store the latest submission for PDF generation
        let latestSubmission = null;

        // Confetti animation
        function triggerConfetti() {
            const duration = 3000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 10001 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                
                confetti(Object.assign({}, defaults, {
                    particleCount,
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
                    colors: ['#8b7355', '#d4a373', '#c9ada7', '#f8f4f1']
                }));
                confetti(Object.assign({}, defaults, {
                    particleCount,
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
                    colors: ['#8b7355', '#d4a373', '#c9ada7', '#f8f4f1']
                }));
            }, 250);
        }

        // Show thank you page with summary
        function showThankYou(data) {
            const overlay = document.getElementById('thankYouOverlay');
            const summary = document.getElementById('responseSummary');
            
            // Build summary HTML
            let summaryHTML = '<h3>Your Response Summary</h3>';
            
            const items = [
                { label: 'Guest Name', value: data.guestName },
                { label: 'Email', value: data.email },
                { label: 'Phone', value: data.phone || 'Not provided' },
                { label: 'Attending', value: data.attending === 'yes' ? '‚úì Yes' : '‚úó No' }
            ];
            
            if (data.attending === 'yes') {
                items.push({ label: 'Number of Guests', value: data.guestCount });
                if (data.guestNames) {
                    items.push({ label: 'Guest Names', value: data.guestNames });
                }
                if (data.dietaryRestrictions) {
                    items.push({ label: 'Dietary Restrictions', value: data.dietaryRestrictions });
                }
            }
            
            if (data.message) {
                items.push({ label: 'Message', value: data.message });
            }
            
            items.forEach(item => {
                summaryHTML += `
                    <div class="response-item">
                        <span class="response-label">${item.label}:</span>
                        <span class="response-value">${item.value}</span>
                    </div>
                `;
            });
            
            summary.innerHTML = summaryHTML;
            
            // Show overlay
            overlay.classList.remove('hidden');
            
            // Trigger confetti
            setTimeout(() => {
                triggerConfetti();
            }, 300);
        }

        // Close thank you overlay
        function closeThankYou() {
            const overlay = document.getElementById('thankYouOverlay');
            overlay.style.animation = 'fadeOut 0.3s ease forwards';
            
            setTimeout(() => {
                overlay.classList.add('hidden');
                overlay.style.animation = '';
                
                // Reset form
                document.getElementById('attendanceForm').reset();
                document.getElementById('guestDetails').classList.add('hidden');
                document.getElementById('guestAllocationInfo').classList.add('hidden');
            }, 300);
        }

        // Add fadeOut animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeOut {
                to {
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Download PDF of response
        function downloadPDF() {
            if (!latestSubmission) return;
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Set colors
            const primaryColor = [139, 115, 85];
            const secondaryColor = [212, 163, 115];
            
            // Add decorative header
            doc.setFillColor(...secondaryColor);
            doc.rect(0, 0, 210, 40, 'F');
            
            // Title
            doc.setFontSize(28);
            doc.setTextColor(255, 255, 255);
            doc.text('Wedding RSVP', 105, 25, { align: 'center' });
            
            // Subtitle
            doc.setFontSize(12);
            doc.text('Response Confirmation', 105, 33, { align: 'center' });
            
            // Reset color for body
            doc.setTextColor(...primaryColor);
            
            let y = 55;
            
            // Add ornament
            doc.setFontSize(20);
            doc.text('‚ù¶', 105, y, { align: 'center' });
            y += 15;
            
            // Response details
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('Response Details', 20, y);
            y += 10;
            
            doc.setFontSize(11);
            doc.setFont(undefined, 'normal');
            
            const addField = (label, value) => {
                if (value && value !== 'Not provided') {
                    doc.setFont(undefined, 'bold');
                    doc.text(`${label}:`, 20, y);
                    doc.setFont(undefined, 'normal');
                    
                    // Handle long text
                    const lines = doc.splitTextToSize(String(value), 150);
                    doc.text(lines, 70, y);
                    y += lines.length * 7;
                }
            };
            
            addField('Submitted', new Date(latestSubmission.timestamp).toLocaleString());
            y += 3;
            addField('Guest Name', latestSubmission.guestName);
            addField('Email', latestSubmission.email);
            addField('Phone', latestSubmission.phone);
            addField('Attending', latestSubmission.attending === 'yes' ? 'Yes, delighted to attend' : 'Regretfully decline');
            
            if (latestSubmission.attending === 'yes') {
                y += 3;
                addField('Number of Guests', latestSubmission.guestCount);
                addField('Guest Names', latestSubmission.guestNames);
                addField('Dietary Restrictions', latestSubmission.dietaryRestrictions);
            }
            
            if (latestSubmission.message) {
                y += 3;
                addField('Message', latestSubmission.message);
            }
            
            // Add footer
            y = 270;
            doc.setFillColor(...secondaryColor);
            doc.rect(0, y, 210, 27, 'F');
            
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('Thank you for your response!', 105, y + 10, { align: 'center' });
            doc.text('We look forward to celebrating with you', 105, y + 17, { align: 'center' });
            
            // Save the PDF
            const fileName = `Wedding_RSVP_${latestSubmission.guestName.replace(/\s+/g, '_')}.pdf`;
            doc.save(fileName);
        }

        // Send email confirmation (requires backend)
        async function sendEmailConfirmation(data) {
            // This would typically call your backend API
            // For now, we'll just log it
            console.log('Email confirmation would be sent to:', data.email);
            
            // In a real implementation, you would:
            // 1. Call your backend API
            // 2. Backend sends email using a service like SendGrid, Mailgun, etc.
            // 3. Return success/failure
            
            // Example structure:
            /*
            try {
                await fetch('YOUR_EMAIL_API_ENDPOINT', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        to: data.email,
                        subject: 'Wedding RSVP Confirmation',
                        data: data
                    })
                });
            } catch (error) {
                console.error('Email send failed:', error);
            }
            */
        }

        // Form submission
        document.getElementById('attendanceForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = this.querySelector('.submit-btn');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;
            
            const formData = new FormData(this);
            const data = {
                timestamp: new Date().toISOString(),
                guestName: formData.get('guestName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                attending: formData.get('attending'),
                guestCount: formData.get('guestCount') || 0,
                dietaryRestrictions: formData.get('dietaryRestrictions'),
                message: formData.get('message'),
                allocatedGuests: guestAllocations[formData.get('guestName')] || 0
            };
            
            // Collect all guest names
            const guestNames = [];
            let i = 1;
            while (formData.get(`guestName${i}`)) {
                guestNames.push(formData.get(`guestName${i}`));
                i++;
            }
            data.guestNames = guestNames.join(', ');
            
            // Store for PDF generation
            latestSubmission = data;
            
            console.log('Form data:', data);
            
            // Send to Google Sheets
            if (GOOGLE_SCRIPT_URL !== 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    // Send email confirmation
                    await sendEmailConfirmation(data);
                    
                    // Success!
                    submitBtn.textContent = '‚úì Submitted!';
                    submitBtn.style.background = 'linear-gradient(135deg, #4a7c59, #5d9c6c)';
                    
                    // Show thank you page
                    setTimeout(() => {
                        showThankYou(data);
                        submitBtn.textContent = originalText;
                        submitBtn.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
                        submitBtn.disabled = false;
                    }, 1000);
                    
                } catch (error) {
                    console.error('Error submitting form:', error);
                    alert('There was an error submitting your response. Please try again or contact us directly.');
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }
            } else {
                // Google Script URL not configured yet - still show thank you page for demo
                submitBtn.textContent = '‚úì Submitted!';
                submitBtn.style.background = 'linear-gradient(135deg, #4a7c59, #5d9c6c)';
                
                setTimeout(() => {
                    showThankYou(data);
                    submitBtn.textContent = originalText;
                    submitBtn.style.background = 'linear-gradient(135deg, var(--primary), var(--secondary))';
                    submitBtn.disabled = false;
                }, 1000);
            }
        });

        // Initialize on load
        initializeForm();
    </script>

    <!-- 
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    GOOGLE SHEETS SETUP INSTRUCTIONS
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    
    Follow these steps to connect this form to Google Sheets:
    
    STEP 1: Create a Google Sheet
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    1. Go to https://sheets.google.com
    2. Create a new spreadsheet
    3. Name it "Wedding RSVP Responses" (or whatever you prefer)
    4. In the first row, add these column headers:
       A1: Timestamp
       B1: Guest Name
       C1: Email
       D1: Phone
       E1: Attending
       F1: Guest Count
       G1: Guest Names
       H1: Dietary Restrictions
       I1: Message
       J1: Allocated Guests
    
    STEP 2: Create Google Apps Script
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    1. In your Google Sheet, click: Extensions ‚Üí Apps Script
    2. Delete any code in the editor
    3. Copy and paste this code:
    
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ  function doPost(e) {                                                 ‚îÇ
    ‚îÇ    try {                                                              ‚îÇ
    ‚îÇ      var sheet = SpreadsheetApp.getActiveSpreadsheet()                ‚îÇ
    ‚îÇ                                .getSheetByName('Sheet1');             ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      // If sheet doesn't exist, get the first sheet                  ‚îÇ
    ‚îÇ      if (!sheet) {                                                    ‚îÇ
    ‚îÇ        sheet = SpreadsheetApp.getActiveSpreadsheet().getSheets()[0]; ‚îÇ
    ‚îÇ      }                                                                ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      var data = JSON.parse(e.postData.contents);                     ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      // Add row to spreadsheet                                       ‚îÇ
    ‚îÇ      sheet.appendRow([                                               ‚îÇ
    ‚îÇ        data.timestamp,                                               ‚îÇ
    ‚îÇ        data.guestName,                                               ‚îÇ
    ‚îÇ        data.email,                                                   ‚îÇ
    ‚îÇ        data.phone,                                                   ‚îÇ
    ‚îÇ        data.attending,                                               ‚îÇ
    ‚îÇ        data.guestCount,                                              ‚îÇ
    ‚îÇ        data.guestNames,                                              ‚îÇ
    ‚îÇ        data.dietaryRestrictions,                                     ‚îÇ
    ‚îÇ        data.message,                                                 ‚îÇ
    ‚îÇ        data.allocatedGuests                                          ‚îÇ
    ‚îÇ      ]);                                                              ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      // Send confirmation email to guest                             ‚îÇ
    ‚îÇ      sendConfirmationEmail(data);                                    ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      return ContentService.createTextOutput(                         ‚îÇ
    ‚îÇ        JSON.stringify({result: 'success'})                           ‚îÇ
    ‚îÇ      ).setMimeType(ContentService.MimeType.JSON);                    ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ    } catch (error) {                                                 ‚îÇ
    ‚îÇ      return ContentService.createTextOutput(                         ‚îÇ
    ‚îÇ        JSON.stringify({result: 'error', error: error.toString()})   ‚îÇ
    ‚îÇ      ).setMimeType(ContentService.MimeType.JSON);                    ‚îÇ
    ‚îÇ    }                                                                  ‚îÇ
    ‚îÇ  }                                                                    ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ  function sendConfirmationEmail(data) {                              ‚îÇ
    ‚îÇ    try {                                                             ‚îÇ
    ‚îÇ      var subject = "Wedding RSVP Confirmation - Thank You!";        ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      // Build email body                                             ‚îÇ
    ‚îÇ      var body = "Dear " + data.guestName + ",\n\n";                 ‚îÇ
    ‚îÇ      body += "Thank you for responding to our wedding invitation! "; ‚îÇ
    ‚îÇ      body += "We have received your RSVP.\n\n";                     ‚îÇ
    ‚îÇ      body += "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";          ‚îÇ
    ‚îÇ      body += "YOUR RESPONSE DETAILS\n";                             ‚îÇ
    ‚îÇ      body += "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";        ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      body += "Attending: " + (data.attending === 'yes' ?            ‚îÇ
    ‚îÇ                              'Yes, delighted to attend' :            ‚îÇ
    ‚îÇ                              'Regretfully decline') + "\n";          ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      if (data.attending === 'yes') {                                 ‚îÇ
    ‚îÇ        body += "Number of Guests: " + data.guestCount + "\n";       ‚îÇ
    ‚îÇ        if (data.guestNames) {                                        ‚îÇ
    ‚îÇ          body += "Guest Names: " + data.guestNames + "\n";          ‚îÇ
    ‚îÇ        }                                                             ‚îÇ
    ‚îÇ        if (data.dietaryRestrictions) {                               ‚îÇ
    ‚îÇ          body += "Dietary Restrictions: " +                          ‚îÇ
    ‚îÇ                  data.dietaryRestrictions + "\n";                    ‚îÇ
    ‚îÇ        }                                                             ‚îÇ
    ‚îÇ      }                                                                ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      if (data.message) {                                             ‚îÇ
    ‚îÇ        body += "Your Message: " + data.message + "\n";              ‚îÇ
    ‚îÇ      }                                                                ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      body += "\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";      ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      if (data.attending === 'yes') {                                 ‚îÇ
    ‚îÇ        body += "We are thrilled you'll be joining us! ";            ‚îÇ
    ‚îÇ        body += "More details about the venue, timing, and ";        ‚îÇ
    ‚îÇ        body += "other arrangements will be shared closer to ";      ‚îÇ
    ‚îÇ        body += "the date.\n\n";                                      ‚îÇ
    ‚îÇ      } else {                                                         ‚îÇ
    ‚îÇ        body += "We're sorry you won't be able to join us, ";        ‚îÇ
    ‚îÇ        body += "but we understand and appreciate you letting ";     ‚îÇ
    ‚îÇ        body += "us know.\n\n";                                       ‚îÇ
    ‚îÇ      }                                                                ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      body += "If you need to update your response, please ";        ‚îÇ
    ‚îÇ      body += "contact us directly.\n\n";                             ‚îÇ
    ‚îÇ      body += "With love and gratitude,\n";                           ‚îÇ
    ‚îÇ      body += "[Your Names]";                                         ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      // Send email                                                    ‚îÇ
    ‚îÇ      MailApp.sendEmail({                                             ‚îÇ
    ‚îÇ        to: data.email,                                               ‚îÇ
    ‚îÇ        subject: subject,                                             ‚îÇ
    ‚îÇ        body: body                                                    ‚îÇ
    ‚îÇ      });                                                              ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ      Logger.log('Confirmation email sent to: ' + data.email);       ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îÇ    } catch (error) {                                                 ‚îÇ
    ‚îÇ      Logger.log('Error sending email: ' + error.toString());        ‚îÇ
    ‚îÇ      // Don't throw error - we still want to save the data          ‚îÇ
    ‚îÇ    }                                                                  ‚îÇ
    ‚îÇ  }                                                                    ‚îÇ
    ‚îÇ                                                                       ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    
    4. Click the disk icon (üíæ) to save
    5. Name your project (e.g., "Wedding RSVP Handler")
    
    IMPORTANT: Update the email signature!
    In the sendConfirmationEmail function, replace "[Your Names]" with your actual names.
    
    STEP 3: Deploy the Script
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    1. Click "Deploy" ‚Üí "New deployment"
    2. Click the gear icon ‚öôÔ∏è next to "Select type"
    3. Choose "Web app"
    4. Configure:
       - Description: "Wedding RSVP Form Handler"
       - Execute as: "Me"
       - Who has access: "Anyone"
    5. Click "Deploy"
    6. Click "Authorize access" and grant permissions
    7. COPY THE WEB APP URL (it looks like: https://script.google.com/macros/s/...)
    
    STEP 4: Update This HTML File
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    1. Find this line in the code (around line 520):
       const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_SCRIPT_URL_HERE';
    
    2. Replace 'YOUR_GOOGLE_SCRIPT_URL_HERE' with your actual URL:
       const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_ACTUAL_URL/exec';
    
    3. Save the HTML file
    
    STEP 5: Test It!
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    1. Open the HTML file in your browser
    2. Fill out the form and submit
    3. Check your Google Sheet - the response should appear!
    
    TROUBLESHOOTING:
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    - If nothing appears in the sheet, check the Apps Script logs:
      In Apps Script editor ‚Üí Executions (left sidebar)
    - Make sure you clicked "Deploy" not just "Test deployments"
    - Make sure the sheet name matches (default is 'Sheet1')
    - Try creating a new deployment if issues persist
    
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    -->
</body>
</html>
